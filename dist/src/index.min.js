!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}function a(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+s).toString(36))}function i(t){return"object"==typeof t?null!==t:"function"==typeof t}function o(t){if(!i(t))throw TypeError(t+" is not an object!");return t}function n(t){try{return!!t()}catch(t){return!0}}function r(t){return d?f.createElement(t):{}}function m(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}var h=t(function(t){var e=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=e)}),y=(h.version,t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),c=t(function(t){var e="__core-js_shared__",n=y[e]||(y[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:h.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),e=0,s=Math.random(),u=t(function(t){var e=c("wks"),n=y.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:a)("Symbol."+t))}).store=e}),l=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=y.document,d=i(f)&&i(f.createElement),p=!l&&!n(function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}),g=Object.defineProperty,v={f:l?Object.defineProperty:function(t,e,n){if(o(t),e=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),o(n),p)try{return g(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},b=l?function(t,e,n){return v.f(t,e,m(1,n))}:function(t,e,n){return t[e]=n,t},x=u("unscopables"),A=Array.prototype;null==A[x]&&b(A,x,{});function w(t){A[x][t]=!0}function _(t,e){return{value:e,done:!!t}}function C(t){return F.call(t).slice(8,-1)}function O(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}function L(t){return P(O(t))}function S(t,e){return D.call(t,e)}function k(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}function T(r,a,t){if(k(r),void 0===a)return r;switch(t){case 1:return function(t){return r.call(a,t)};case 2:return function(t,e){return r.call(a,t,e)};case 3:return function(t,e,n){return r.call(a,t,e,n)}}return function(){return r.apply(a,arguments)}}var R={},F={}.toString,P=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==C(t)?t.split(""):Object(t)},D={}.hasOwnProperty,j=c("native-function-to-string",Function.toString),E=t(function(t){var i=a("src"),e="toString",o=(""+j).split(e);h.inspectSource=function(t){return j.call(t)},(t.exports=function(t,e,n,r){var a="function"==typeof n;a&&(S(n,"name")||b(n,"name",e)),t[e]!==n&&(a&&(S(n,i)||b(n,i,t[e]?""+t[e]:o.join(String(e)))),t===y?t[e]=n:r?t[e]?t[e]=n:b(t,e,n):(delete t[e],b(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[i]||j.call(this)})}),N="prototype",I=function(t,e,n){var r,a,i,o,c=t&I.F,s=t&I.G,u=t&I.S,l=t&I.P,f=t&I.B,d=s?y:u?y[e]||(y[e]={}):(y[e]||{})[N],p=s?h:h[e]||(h[e]={}),g=p[N]||(p[N]={});for(r in s&&(n=e),n)i=((a=!c&&d&&void 0!==d[r])?d:n)[r],o=f&&a?T(i,y):l&&"function"==typeof i?T(Function.call,i):i,d&&E(d,r,i,t&I.U),p[r]!=i&&b(p,r,o),l&&g[r]!=i&&(g[r]=i)};y.core=h,I.F=1,I.G=2,I.S=4,I.P=8,I.B=16,I.W=32,I.U=64,I.R=128;function B(t){return isNaN(t=+t)?0:(0<t?q:W)(t)}function M(t){return 0<t?K(B(t),9007199254740991):0}function z(c){return function(t,e,n){var r,a=L(t),i=M(a.length),o=function(t,e){return(t=B(t))<0?Y(t+e,0):X(t,e)}(n,i);if(c&&e!=e){for(;o<i;)if((r=a[o++])!=r)return!0}else for(;o<i;o++)if((c||o in a)&&a[o]===e)return c||o||0;return!c&&-1}}function V(t){return Q[t]||(Q[t]=a(t))}function G(){}function U(t,e,n){t&&!S(t=n?t:t.prototype,lt)&&ut(t,lt,{configurable:!0,value:e})}var H=I,W=Math.ceil,q=Math.floor,K=Math.min,Y=Math.max,X=Math.min,Q=c("keys"),J=z(!1),Z=V("IE_PROTO"),tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),et=Object.keys||function(t){return function(t,e){var n,r=L(t),a=0,i=[];for(n in r)n!=Z&&S(r,n)&&i.push(n);for(;e.length>a;)S(r,n=e[a++])&&(~J(i,n)||i.push(n));return i}(t,tt)},nt=l?Object.defineProperties:function(t,e){o(t);for(var n,r=et(e),a=r.length,i=0;i<a;)v.f(t,n=r[i++],e[n]);return t},rt=y.document,at=rt&&rt.documentElement,it=V("IE_PROTO"),ot="prototype",ct=function(){var t,e=r("iframe"),n=tt.length;for(e.style.display="none",at.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ct=t.F;n--;)delete ct[ot][tt[n]];return ct()},st=Object.create||function(t,e){var n;return null!==t?(G[ot]=o(t),n=new G,G[ot]=null,n[it]=t):n=ct(),void 0===e?n:nt(n,e)},ut=v.f,lt=u("toStringTag"),ft={};b(ft,u("iterator"),function(){return this});function dt(t){return Object(O(t))}function pt(){return this}var gt=V("IE_PROTO"),ht=Object.prototype,yt=Object.getPrototypeOf||function(t){return t=dt(t),S(t,gt)?t[gt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ht:null},vt=u("iterator"),xt=!([].keys&&"next"in[].keys()),mt="values",bt=function(t,e,n,r,a,i,o){!function(t,e,n){t.prototype=st(ft,{next:m(1,n)}),U(t,e+" Iterator")}(n,e,r);function c(t){if(!xt&&t in g)return g[t];switch(t){case"keys":case mt:return function(){return new n(this,t)}}return function(){return new n(this,t)}}var s,u,l,f=e+" Iterator",d=a==mt,p=!1,g=t.prototype,h=g[vt]||g["@@iterator"]||a&&g[a],y=h||c(a),v=a?d?c("entries"):y:void 0,x="Array"==e&&g.entries||h;if(x&&(l=yt(x.call(new t)))!==Object.prototype&&l.next&&(U(l,f,!0),"function"!=typeof l[vt]&&b(l,vt,pt)),d&&h&&h.name!==mt&&(p=!0,y=function(){return h.call(this)}),!xt&&!p&&g[vt]||b(g,vt,y),R[e]=y,R[f]=pt,a)if(s={values:d?y:c(mt),keys:i?y:c("keys"),entries:v},o)for(u in s)u in g||E(g,u,s[u]);else H(H.P+H.F*(xt||p),e,s);return s}(Array,"Array",function(t,e){this._t=L(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,_(1)):_(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");R.Arguments=R.Array,w("keys"),w("values"),w("entries");for(var At=u("iterator"),wt=u("toStringTag"),_t=R.Array,Ct={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Ot=et(Ct),Lt=0;Lt<Ot.length;Lt++){var St,kt=Ot[Lt],Tt=Ct[kt],Rt=y[kt],Ft=Rt&&Rt.prototype;if(Ft&&(Ft[At]||b(Ft,At,_t),Ft[wt]||b(Ft,wt,kt),R[kt]=_t,Tt))for(St in bt)Ft[St]||E(Ft,St,bt[St],!0)}var Pt=u("toStringTag"),Dt="Arguments"==C(function(){return arguments}()),jt={};jt[u("toStringTag")]="z",jt+""!="[object z]"&&E(Object.prototype,"toString",function(){return"[object "+function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Pt))?n:Dt?C(e):"Object"==(r=C(e))&&"function"==typeof e.callee?"Arguments":r}(this)+"]"},!0);var Et,Nt,It,Bt;Et="keys",Nt=function(){return function(t){return et(dt(t))}},It=(h.Object||{})[Et]||Object[Et],(Bt={})[Et]=Nt(It),H(H.S+H.F*n(function(){It(1)}),"Object",Bt);function Mt(t,e){return new(function(t){var e;return Vt(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!Vt(e.prototype)||(e=void 0),i(e)&&null===(e=e[Gt])&&(e=void 0)),void 0===e?Array:e}(t))(e)}function zt(f,t){var d=1==f,p=2==f,g=3==f,h=4==f,y=6==f,v=5==f||y,x=t||Mt;return function(t,e,n){for(var r,a,i=dt(t),o=P(i),c=T(e,n,3),s=M(o.length),u=0,l=d?x(t,s):p?x(t,0):void 0;u<s;u++)if((v||u in o)&&(a=c(r=o[u],u,i),f))if(d)l[u]=a;else if(a)switch(f){case 3:return!0;case 5:return r;case 6:return u;case 2:l.push(r)}else if(h)return!1;return y?-1:g||h?h:l}}var Vt=Array.isArray||function(t){return"Array"==C(t)},Gt=u("species"),Ut=zt(5),Ht="find",Wt=!0;Ht in[]&&Array(1)[Ht](function(){Wt=!1}),H(H.P+H.F*Wt,"Array",{find:function(t,e){return Ut(this,t,1<arguments.length?e:void 0)}}),w(Ht);function qt(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}var Kt=zt(1);H(H.P+H.F*!qt([].map,!0),"Array",{map:function(t,e){return Kt(this,t,e)}});var Yt=[].sort,Xt=[1,2,3];H(H.P+H.F*(n(function(){Xt.sort(void 0)})||!n(function(){Xt.sort(null)})||!qt(Yt)),"Array",{sort:function(t){return void 0===t?Yt.call(dt(this)):Yt.call(dt(this),k(t))}});var Qt=v.f,$t=Function.prototype,Jt=/^\s*function ([^ (]*)/;"name"in $t||l&&Qt($t,"name",{configurable:!0,get:function(){try{return(""+this).match(Jt)[1]}catch(t){return""}}});var Zt=zt(0),te=qt([].forEach,!0);H(H.P+H.F*!te,"Array",{forEach:function(t,e){return Zt(this,t,e)}});var ee=zt(2);H(H.P+H.F*!qt([].filter,!0),"Array",{filter:function(t,e){return ee(this,t,e)}});var ne=z(!1),re=[].indexOf,ae=!!re&&1/[1].indexOf(1,-0)<0;H(H.P+H.F*(ae||!qt(re)),"Array",{indexOf:function(t,e){return ae?re.apply(this,arguments)||0:ne(this,t,e)}});function ie(t){var x,s,a,i=0<arguments.length&&void 0!==t?t:"",u=[],l="init",o=850-0-0,c=290-0-0,e=520-0-5,n=35-7-0,r=d3.select(".data.EAdata").append("svg").attr("id","barChart_groupEastAsia"),f=d3.select(".data.NAdata").append("svg").attr("id","barChart_groupNAmer"),d=d3.select(".data.EUdata").append("svg").attr("id","barChart_groupRow3"),p=d3.select(".data.dataRow4").append("svg").attr("id","barChart_groupRow4"),g=d3.select("#barChartLegend").select("svg").attr("width",e).attr("height",n).attr("transform","translate(120,0)").style("vertical-align","middle"),h=d3.select("#mycityCardDiv"),y=d3.select();function v(t){var e=t;y.remove();var n=h.selectAll(".cardrow",function(t){return t.id}).data(e);n.enter().append("div").attr("class",function(t,e){return 0===e?"cardrow titlerow row".concat(e):"cardrow subrow row".concat(e)}).html(function(t){return t.text}),n.attr("class",function(t,e){return 0===e?"cardrow titlerow row".concat(e):"cardrow updated row".concat(e)}).html(function(t){return t.text}),y=n.exit().attr("class","oldrow removed").html(function(t){})}function m(n){var r=[];return x.filter(function(t){if(t.region===n){var e={};e.region=t.region,e.city=t.city,e.s1PerCap=t.s1PerCap,e.storeOrig=t.storeOrig?t.storeOrig:null,r.push(e)}}),r.sort(function(t,e){return d3.descending(t.s1PerCap,e.s1PerCap)}),r}function b(t,e){t.sort(function(t,e){return d3.descending(t.s1PerCap,e.s1PerCap)});for(var n=0;n<e;n++){var r={};r.region=t[0].region,r.city="".concat(t[0].region,"_gap").concat(n),r.s1PerCap=null,r.storeOrig=null,t.push(r)}return t}function A(t,e,n){var r=[];if(r=m(n),"Europe"===n)r=b(r,3).concat(m("Southeast Asia"));else if("Latin America & Caribbean"===n){var a=b(r,2),i=b(m("South Asia"),2),o=b(m("Africa"),2),c=b(m("N Africa & W Asia"),1),s=m("Oceania");r=a.concat(i).concat(o).concat(c).concat(s)}else"North America"===n&&(r=b(r,1));barChart(t,e,r),d3.select("#barChart_groupEastAsia").select(".margin-offset").attr("transform","translate(0, -70)"),d3.select("#barChart_groupNAmer").select(".margin-offset").attr("transform","translate(0, -115)"),d3.select("#barChart_groupRow3").select(".margin-offset").attr("transform","translate(0, -150)"),d3.select("#barChart_groupRow4").select(".margin-offset").attr("transform","translate(0, -190)");var u=d3.select("body").append("div").attr("class","tooltip-bar").style("opacity",0);d3.selectAll(".x.axis").selectAll("text").on("touchmove mousemove",function(t,e){if(d3.selectAll(".enlarged").classed("enlarged",!1),-1===d3.select(this).text().indexOf("_gap")){var n=i18next.t(d3.select(this).text(),{ns:"cities"});d3.select(this).classed("enlarged",!0),d3.selectAll(".x.axis g :not(#text_".concat(n,")")).classed("fadeText",!0),C(d3.select(this).text())}}).on("mouseout",function(t){d3.selectAll(".x.axis g text").classed("fadeText",!1),L();var e=d3.select(".enlarged").text();d3.select(".bar-group.".concat(i18next.t(e,{ns:"cities"}))).select("rect").classed("active",!0),d3.select("#city".concat(i18next.t(e,{ns:"cities"}))).classed("cityactive",!0)}),d3.selectAll(".bar-group").on("touchmove mousemove",function(t,e){d3.selectAll(".enlarged").classed("enlarged",!1);var n=i18next.t(t.city,{ns:"cities"});d3.select("#text_".concat(n)).classed("enlarged",!0);var r=e+1;C(t.city);var a=i18next.t(t.city,{ns:"displayName"}),i=t.storeOrig?t.storeOrig:t.value;u.style("opacity",1),u.html("#".concat(r,". ").concat(a," <br>").concat(he.formatNum(i)," ").concat(i18next.t("emissions per cap",{ns:"units"}))).style("left",d3.event.pageX+30+"px").style("top",d3.event.pageY+-50+"px")}).on("mouseout",function(t){u.style("opacity",0),L();var e=d3.select(".enlarged").text();d3.select(".bar-group.".concat(i18next.t(e,{ns:"cities"}))).select("rect").classed("active",!0),d3.select("#city".concat(i18next.t(e,{ns:"cities"}))).classed("cityactive",!0)})}function w(){function t(t,e){return le[l].colourRange[e]}function e(t,e){return"protocol"===l?i18next.t("".concat(l).concat(e+1),{ns:"legend"}):"region"===l?"":(n=0===e?u[l].lims[e]:u[l].levels[e-1],n=le[l].formatLevel?le[l].formatLevel(n):n,"".concat(n,"+"));var n}var n=le[l].xpos,r=d3.select("body").append("div").attr("class","tooltip-legend").style("opacity",0),a=g.attr("class","legendCB").selectAll(".legend").data(le[l].colourRange),i=a.enter().append("g").attr("class","legend").attr("id",function(t,e){return"cb".concat(e)});i.append("rect").attr("width",15).attr("height",15).attr("y",5).attr("x",function(t,e){return 51+85*e}).attr("fill",t),i.selectAll(".legend rect").on("touchmove mousemove",function(t,e){if("protocol"===l){var n=i18next.t("".concat(l).concat(e+1),{ns:"legend"});r.style("opacity",1),r.html("<b>".concat(n,"</b>: ").concat(i18next.t("".concat(n),{ns:"protocolFullName"}))).style("left",d3.event.pageX-100+"px").style("top",d3.event.pageY-70+"px")}}).on("mouseout",function(t){r.style("opacity",0)}),i.append("text").attr("class","legendText").text(e).attr("y",18).attr("x",function(t,e){return n[e]}),a.select("rect").attr("fill",t),a.select("text").text(e).attr("x",function(t,e){return n[e]}),a.exit().remove();var o=le[l].units,c=d3.select(".units");c.text(o),"HDD"===l||"HDD"===l||"low_bua_pc_2014"===l||"high_bua_pc_2014"===l?d3.select(".units").classed("unitsactive",!0):d3.select(".units").classed("unitsactive",!1);var s=d3.select("body").append("div").attr("class","tooltip-units").style("opacity",0);c.on("touchmove mousemove",function(){le[l].unitdef&&(s.style("opacity",1),s.html("<b>".concat(i18next.t(l,{ns:"attributes"}),"</b>: ").concat(le[l].unitdef)).style("left",d3.event.pageX-100+"px").style("top",d3.event.pageY-70+"px"))}).on("mouseout",function(t){s.style("opacity",0)})}function _(t){d3.select("#".concat(t)).text(i18next.t(t,{ns:"chartHeadings"}))}function C(e){var t=i18next.t(e,{ns:"cities"});L();var n=x.filter(function(t){return t.city===e})[0].country,r=x.filter(function(t){return t.city===e})[0].scope1,a=x.filter(function(t){return t.city===e})[0].year,i=x.filter(function(t){return t.city===e})[0].dataset,o=x.filter(function(t){return t.city===e})[0].protocol,c=i18next.t(e,{ns:"displayName"});s=[{id:1,text:"".concat(c,", ").concat(n)},{id:2,text:i18next.t("scope1Row",{ns:"cityCard"})},{id:3,text:"".concat(r," ").concat(i18next.t("scope1",{ns:"units"})," ").concat(i18next.t("defn",{ns:"units"}))},{id:4,text:i18next.t("yearRow",{ns:"cityCard"})},{id:5,text:a},{id:6,text:i18next.t("datasetRow",{ns:"cityCard"})},{id:7,text:i18next.t(i,{ns:"datasets"})},{id:8,text:i18next.t("protocolRow",{ns:"cityCard"})},{id:9,text:i18next.t(o,{ns:"protocol"})}],u[l]&&"protocol"!==l&"year"!==l&&O(l,e),v(s),d3.select(".bar-group.".concat(t)).select("rect").classed("active",!0),d3.selectAll(".bar-group:not(.".concat(t,")")).select("rect").classed("fade",!0),d3.selectAll("#city"+t).classed("cityactive",!0),d3.selectAll(".worldcity:not(#city"+t+")").classed("cityfade",!0),d3.selectAll(".worldcountry:not(#map".concat(i18next.t(n,{ns:"countries"}),")")).classed("countryfade",!0)}function O(t,e){var n,r=u[t].filter(function(t){return t.city===e})[0].value,a="N/A"===(n="string"==typeof r||r instanceof String?r:null===r?"N/A":d3.format(",")(r)?d3.format(",")(r):r)?"":i18next.t(t,{ns:"units"});s.push({id:10,text:i18next.t(t,{ns:"attributes"})},{id:11,text:"".concat(n," ").concat(a)})}function L(){d3.selectAll(".bar-group").selectAll("rect").classed("active",!1).classed("fade",!1),d3.selectAll(".cityactive").classed("cityactive",!1),d3.selectAll(".cityfade").classed("cityfade",!1),d3.selectAll(".countryfade").classed("countryfade",!1)}function S(e){var a,i=[],o=i18next.t(e,{ns:"barchartGroups"});a="Europe"===e?"".concat(o,"_").concat(e):"Southeast Asia"===e?"".concat(o,"_SEasia"):"Latin America & Caribbean"===e?"".concat(o,"_LA"):"South Asia"===e?"".concat(o,"_SA"):"N Africa & W Asia"===e?"".concat(o,"_NAWA"):o;var c=pe[a].xpos,s=pe[a].ypos,u=pe[a].arrowlength,l=pe[a].gid,f=0,d=0,p=0,g=0,h=200-g-d,y=200-f-p,v=[],n=0;x.filter(function(t){t.region===e&&t.storeOrig&&(v.push(t.storeOrig),i.push({id:n,name:"arrow"+n,path:"M 2,2 L2,11 L10,6 L2,2"}),n++)});for(var t=function(e){var t=d3.select("#barChart_".concat(o)).append("g").attr("class","barMarker").attr("id","g_".concat(l).concat(e)).attr("height",y+f+p).attr("transform","translate("+c[e]+","+s[e]+")").append("svg").attr("width",h+g+d),n=t.append("svg:defs"),r=t.append("svg:g").attr("id","markers".concat(e));n.selectAll("marker").data(i).enter().append("svg:marker").attr("id",function(t){return"marker_arrow".concat(e)}).attr("markerHeight",13).attr("markerWidth",13).attr("markerUnits","strokeWidth").attr("orient","auto").attr("refX",9.5).attr("refY",6).append("svg:path").attr("d",function(t){return t.path}),r.selectAll("path").data(i).enter().append("svg:path").attr("d",function(t,e){return"M 100, 0 V ".concat(u,", 0 ")}).attr("stroke-width",1.2).attr("marker-start",function(t){return"url(#marker_stub".concat(e,")")}).attr("marker-end",function(t){return"url(#marker_arrow".concat(e,")")}).attr("transform",function(t){return"scale(".concat(pe[a].arrowscale[0]," ").concat(pe[a].arrowscale[1],")")}).append("svg:path").attr("d",function(t){return t.path}),d3.select("#g_".concat(l).concat(e)).append("text").text(v[e]).attr("transform",function(){return"scale(".concat(pe[a].textscale[0]," ").concat(pe[a].textscale[1],")\n              translate(").concat(pe[a].textposx[e]," ").concat(pe[a].textposy[e],")")})},r=0;r<v.length;r++)t(r)}d3.select("#mapResetButton").on("click",function(){d3.selectAll(".enlarged").classed("enlarged",!1),d3.selectAll("rect.active").classed("active",!1),d3.selectAll(".cityactive").classed("cityactive",!1)}),i18n.load(["".concat(i,"/src/i18n")],function(){d3.queue().defer(d3.json,"".concat(i,"/data/cityApp_attributes_consolidated_fixedSet.json")).await(function(t,e){(x=e).map(function(e){e.scope1=d3.format(".3n")(e.scope1/1e6),Object.keys(ge).find(function(t){return t===e.city})&&(e.storeOrig=e.s1PerCap,e.s1PerCap=ge[e.city])}),d3.select("#download").html(i18next.t("downloadText",{ns:"pageText"})),d3.select("#titletag").html(i18next.t("titletag",{ns:"pageText"})),d3.select("#pageTitle").html(i18next.t("title",{ns:"pageText"})),function(){var t=[{name:"Natural Earth",projection:d3.geoNaturalEarth()}];t.forEach(function(t){t.projection.rotate([0,0]).center([40,0])});var e=t[0].projection.scale(151).translate([o/1.655,c/1.67]);a=d3.geoPath().projection(e).pointRadius([3]);var n=d3.geoGraticule(),r=d3.select("#map").append("svg").attr("width",o).attr("height",c).attr("transform","translate(-25,0)").append("g");r.append("path").datum({type:"Sphere"}).attr("class","sphere").attr("d",a).attr("fill","#F4F7F7").attr("stroke","grey"),r.append("path").datum(n).attr("class","graticule").attr("d",a),d3.json("".concat(i,"/geojson/world_countries.json"),function(t,n){if(t)throw t;d3.json("".concat(i,"/geojson/our_cities.geojson"),function(t,e){if(t)throw t;r.attr("class","mapg").selectAll("path").data(n.features).enter().append("path").attr("d",a).attr("id",function(t){var e=i18next.t(t.properties.name,{ns:"countries"});return"map".concat(e)}).attr("class","worldcountry").style("stroke-width",1),e=r.selectAll("path").data(e.features).enter().append("path").attr("d",a).attr("id",function(t){var e=i18next.t(t.id,{ns:"reverse"});return"city"+i18next.t(e,{ns:"cities"})}).attr("class",function(t){var e=i18next.t(t.id,{ns:"reverse"}),n=x.filter(function(t){return t.city===e})[0];return n?"worldcity ".concat(i18next.t(n.region,{ns:"regions"})):"horsService"}).attr("r",10).on("mouseover",function(t){d3.selectAll(".enlarged").classed("enlarged",!1);var e=i18next.t(t.id,{ns:"reverse"});d3.select("#text_".concat(i18next.t(e,{ns:"cities"}))).classed("enlarged",!0),C(e)}).on("mouseout",function(t){L();var e=d3.select(".enlarged").text();d3.select(".bar-group.".concat(i18next.t(e,{ns:"cities"}))).select("rect").classed("active",!0),d3.select("#city".concat(i18next.t(e,{ns:"cities"}))).classed("cityactive",!0)})})})}(),d3.select("#mycityCardDiv").append("svg").attr("width",273).attr("height",c).attr("width",fe).attr("height",c).append("g").attr("id","cityCardg").append("rect").attr("width",de.width).attr("height",de.height).attr("x",de.pos[0]).attr("y",de.pos[1]),v([{id:1,text:i18next.t("initTitle",{ns:"cityCard"})},{id:2,text:i18next.t("initRow1",{ns:"cityCard"})},{id:3,text:i18next.t("initRow2",{ns:"cityCard"})},{id:4,text:i18next.t("initRow3",{ns:"cityCard"})},{id:5,text:i18next.t("initRow4",{ns:"cityCard"})}]),A(r,oe,"East Asia"),A(f,ce,"North America"),A(d,se,"Europe"),A(p,ue,"Latin America & Caribbean"),d3.selectAll(".data svg").style("overflow","visible"),d3.select("#barChart_groupRow3").append("text").attr("text-anchor","middle").text(i18next.t("yaxText",{ns:"chartHeadings"})).attr("class","yaxLabel").attr("transform",function(t){return"translate(-35 -135)rotate(-90)"}),S("East Asia"),S("North America"),S("Europe"),S("Southeast Asia"),S("Latin America & Caribbean"),S("South Asia"),_("h1"),_("h2"),_("h3"),_("h4"),_("h5"),_("h6"),_("h7"),_("h8"),_("h9")})}),$(document).on("change",function(t){d3.selectAll(".data").selectAll("rect").classed("isNan",!1),"none"===(l=t.target.value)?(d3.selectAll(".bar-group rect").style("fill","#4a6072"),w()):function(a){u[l]?a():d3.json("".concat(i,"/data/cityApp_attributes_consolidated_").concat(l,".json"),function(t,e){if(u[l]=e,le[l].whichLim)if("d3extent"===le[l].whichLim)u[l].lims=d3.extent(u[l],function(t){return t.value});else if("d3mean"===le[l].whichLim){var n=d3.mean(u[l],function(t){return t.value});u[l].lims=[n-ye(n,.9545),n+ye(n,.9545)]}if(u[l].lims&&le[l].modx){var r=le[l].modx;u[l].lims=u[l].lims.map(function(t){return Math.floor(t/r)*r})}a()})}(function(){if(function(){if(u[l].lims){var t,e=u[l].lims[0],n=u[l].lims[1],r=d3.scaleQuantile().domain([e,n]).range(le[l].colourRange);t=le[l].cbValues?le[l].cbValues:r.quantiles(),u[l].mappingFn=r,u[l].levels=t}}(),d3.selectAll(".bar-group").each(function(t){if(-1===t.city.indexOf("_gap")){var e,n=t.city;if("region"===l){var r=u[l].filter(function(t){return t.city===n})[0].value;e=i18next.t(r,{ns:"regionColours"})}else{var a=u[l].filter(function(t){return t.city===n})[0].value;e=null===a?(d3.select(this).select("rect").classed("isNan",!0),"none"):u[l].mappingFn(a)}d3.select(this).select("rect").style("fill",e)}}),w(),s){if(s[9]&&(s=s.slice(0,9),"protocol"===l||"year"===l))return void v(s);if("protocol"!==l&&"year"!==l){var t=d3.selectAll(".enlarged").text();O(l,t),v(s)}}})})}var oe={aspectRatio:8.2,margin:{top:33,right:0,bottom:20,left:0},width:1300,groupPadding:0,pOuter:.9,pInner:.15,filterData:function(t){return[{category:i18next.t(t[0].region,{ns:"regions"}),values:t.map(function(t,e){return{city:t.city,value:t.s1PerCap,storeOrig:t.storeOrig,idx:e}})}]},x:{getId:function(t){return t.city},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},getDomain:function(t){return[0,10]},ticks:5,tickSizeOuter:1},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"rail"})}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},ce={aspectRatio:8.2,margin:{top:0,left:0,right:0,bottom:30},width:1200,groupPadding:0,pOuter:.9,pInner:.15,filterData:function(t){return[{category:i18next.t(t[0].region,{ns:"regions"}),values:t.map(function(t,e){return{city:t.city,value:t.s1PerCap,storeOrig:t.storeOrig,idx:e}})}]},x:{getId:function(t){return t.city},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},getDomain:function(t){return[0,10]},ticks:5,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return console.log(e),e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"rail"})}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},se={aspectRatio:8.2,margin:{top:10,left:0,right:0,bottom:20},width:1200,groupPadding:0,pOuter:.9,pInner:.15,filterData:function(t){return[{category:i18next.t(t[0].region,{ns:"regions"}),values:t.map(function(t,e){return{city:t.city,region:i18next.t(t.region,{ns:"regions"}),value:t.s1PerCap,storeOrig:t.storeOrig,idx:e}})}]},x:{getId:function(t){return t.city},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getRegion:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[0].region},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},getDomain:function(t){return[0,10]},ticks:5,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"rail"})}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},ue={aspectRatio:8.2,margin:{top:10,left:0,right:0,bottom:20},width:1200,groupPadding:0,pOuter:.9,pInner:.15,filterData:function(t){return[{category:i18next.t(t[0].region,{ns:"regions"}),values:t.map(function(t,e){return{city:t.city,region:i18next.t(t.region,{ns:"regions"}),value:t.s1PerCap,storeOrig:t.storeOrig,idx:e}})}]},x:{getId:function(t){return t.city},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getRegion:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[0].region},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},getDomain:function(t){return[0,10]},ticks:5,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"rail"})}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},le={none:{colourRange:[]},region:{colourRange:[],units:[]},protocol:{whichLim:"d3extent",colourRange:["#9DD3DF","#8856a7","#E35B5D","#EB9F9F","#F18052","#F4DD51"],cbValues:[1,2,3,4,5,6],xpos:[22,86,190,273,355,417],units:[]},year:{whichLim:"d3extent",modx:5,colourRange:["#a63603","#e6550d","#997E68","#fd8d3c","#fecc5c"],xpos:[13,98,182,267,353],units:[]},population:{whichLim:"d3extent",colourRange:["#DED8B6","#fbb4b9","#f768a1","#c51b8a","#7a0177"],xpos:[18,97,182,271,356],units:[],formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2s")(e)}},GDP_PPP_percap:{whichLim:"d3mean",modx:1e3,colourRange:["#b8aca2","#E394A7","#9e9ac8","#756bb1","#54278f"],xpos:[17,105,190,275,360],units:["[$BN/capita]"],formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2s")(e)}},area:{whichLim:"d3mean",modx:100,colourRange:["#ffffcc","#c7e9b4","#41b6c4","#2c7fb8","#253494"],xpos:[32,104,189,275,361],units:["[km2]"]},pop_density:{whichLim:"d3mean",modx:100,colourRange:["#ffffcc","#F9C869","#E1F5C4","#ADD6BC","#486d6c"],xpos:[20,100,183,268,346],units:["[per km2]"]},diesel:{whichLim:"d3extent",colourRange:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],xpos:[17,101,187,271,356],units:["[USD/litre]"],formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2f")(e)}},gas:{whichLim:"d3extent",colourRange:["#F1F2C4","#fecc5c","#fd8d3c","#f03b20","#bd0026"],xpos:[16,102,185,271,357],units:["[USD/litre]"],formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2f")(e)}},HDD:{whichLim:"d3extent",modx:1e3,colourRange:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],xpos:[32,97,182,268,352],units:["[deg C x days]"],unitdef:"Heating degree days, used to estimate the energy needed to heat a building above the base temperature (15.5C here)."},CDD:{whichLim:"d3extent",modx:1e3,colourRange:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],xpos:[32,104,189,268,352],units:["[deg C x days]"],unitdef:"Cooling degree days, used to estimate the energy needed to cool a building below the base temperature (23C here)."},low_bua_pc_2014:{whichLim:"d3extent",colourRange:["#ECDAA8","#B6AC7B","#8C9C82","#9AA0AC","#70725A"],xpos:[16,101,185,270,355],units:["[% of tot BUA]"],unitdef:"An urbran expansion attribute that quantifies the fraction of low built-up area (BUA) out of the total city area in 2014.",formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2f")(e)}},high_bua_pc_2014:{whichLim:"d3extent",colourRange:["#ECDAA8","#B6AC7B","#8C9C82","#9AA0AC","#70725A"],xpos:[16,101,185,270,355],units:["[% of tot BUA]"],unitdef:"An urbran expansion attribute that quantifies the fraction of high built-up area (BUA) out of the total city area in 2014.",formatLevel:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d3.format(".2f")(e)}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},fe=250,de={width:210,height:310,pos:[20,-20]},pe={groupEastAsia:{xpos:[-15,-2,9],ypos:[-100,-95,-91],arrowlength:33,arrowscale:[.6,.8],gid:"EA",textscale:[1,1],textposx:[40,60,65],textposy:[-2,2,10]},groupNAmer:{xpos:[-20,-3,13,30],ypos:[-145,-139,-137,-135],arrowlength:33,arrowscale:[.6,.8],gid:"NAmer",textscale:[.9,.9],textposx:[28,112,33,51],textposy:[0,14,-4,-5]},groupRow3_Europe:{xpos:[-21],ypos:[-172],arrowlength:30,arrowscale:[.6,.8],gid:"EU",textscale:[.9,.9],textposx:[55],textposy:[-5]},groupRow3_SEasia:{xpos:[761],ypos:[-178],arrowlength:30,arrowscale:[.6,.8],gid:"SEA",textscale:[.9,.9],textposx:[75],textposy:[10]},groupRow4_LA:{xpos:[-22],ypos:[-220],arrowlength:30,arrowscale:[.6,.8],gid:"LA",textscale:[.9,.9],textposx:[75],textposy:[14]},groupRow4_SA:{xpos:[413],ypos:[-220],arrowlength:30,arrowscale:[.6,.8],gid:"SA",textscale:[.9,.9],textposx:[72],textposy:[14]}},ge={Inch:11,Kaoh:11,Yila:11,Clev:11.1,"L V":11.1,Sava:11.1,"F C":11,Rott:11,Quez:11,"LeÃ³":11,Gand:11},he={_selfFormatter:i18n.getNumberFormatter(2),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)}},ye=function(t,e){return(arguments.length<=0?void 0:t)*(arguments.length<=1?void 0:e)};"undefined"!=typeof Drupal?Drupal.behaviors.dv={attach:function(t,e){ie(Drupal.settings.dv&&Drupal.settings.dv.urlRoot?Drupal.settings.dv.urlRoot:"")}}:ie()}();