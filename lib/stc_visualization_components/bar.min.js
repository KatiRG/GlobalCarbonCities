!function(t){var a={margin:{top:0,right:0,bottom:30,left:0},x:{getDomain:function(t){var a,e,n,i=[];for(a=0;a<t.length;a++)e=t[a],n=this.x.getValue.call(this,e),-1===i.indexOf(n)&&i.push(n);return i}},y:{getDomain:function(t){var a=d3.min(t,this.y.getValue.bind(this)),e=d3.max(t,this.y.getValue.bind(this));return a>0&&(a=0),e<0&&(e=0),this.showValues&&(a<0&&(a-=.09*(e-a)),e>0&&(e+=.06*(e-a))),[a,e]}},z:{getDomain:function(t){var a,e,n,i=[];for(a=0;a<t.length;a++)e=t[a],n=this.z.getId.call(this,e),-1===i.indexOf(n)&&i.push(n);return i}},groupPadding:.2,barPadding:.1,aspectRatio:16/9,width:600,barTableID:"barTable"};this.barChart=function(e,n,i){var r,l,s,c,o,d,u=t(!0,{},a,n),g=u.width,x=Math.ceil(g/u.aspectRatio),f=u.innerHeight=x-u.margin.top-u.margin.bottom,p=u.innerWidth=g-u.margin.left-u.margin.right,h=e.select("g.margin-offset"),m=h.select(".data"),y=d3.transition().duration(1e3);return o={settings:u,clear:function(){m.remove()},svg:e},e.attr("viewBox","-50 0 "+(g+50)+" "+(x+10)).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",u.altText),h.empty()&&(h=e.append("g").attr("class","margin-offset").attr("transform","translate("+u.margin.left+","+u.margin.top+")")),d=function(){(function(){var t,a=this.settings,e=a.filterData&&"function"==typeof a.filterData?a.filterData.call(a,i):i,d=[].concat.apply([],e.map(function(t){return a.z.getDataPoints.call(a,t)})),u=h.select(".x.axis"),g=h.select(".y.axis"),x=a.showValues,b=function(t,e){var n="bar-group bar-group"+(e+1);const i=i18next.t(a.x.getClass.call(a,t),{ns:"cities"})?i18next.t(a.x.getClass.call(a,t),{ns:"cities"}):a.x.getClass.call(a,t);return a.x&&a.x.getClass&&"function"==typeof a.x.getClass&&(n+=" "+i),a.x&&a.x.getRegion&&"function"==typeof a.x.getRegion&&(n+=" HERE"+a.x.getRegion.call(a,t)),n},v=function(){return"translate("+l(a.x.getValue.apply(a,arguments))+",0)"},k=function(t,e){var n="bar bar"+(e+1);return a.x&&a.z.getClass&&"function"==typeof a.z.getClass&&(n+=" "+a.z.getClass.call(a,t)),n},z=function(){var t=d3.select(this),n=a.x.getValue.call(a,t.data()[0]),i=function(t){return a.z.getDataPoints.call(a,t).filter(function(t){return a.x.getValue.call(a,t)===n})[0]},l=t.selectAll(".bar").data(e,a.z.getId.bind(a));t.selectAll(".value").data(function(){return"function"==typeof x?e.filter(function(t){return x.call(a,i(t))}):!0!==x?[]:e},a.z.getId.bind(a)),l.enter().append("rect").attr("x",O).attr("width",r.bandwidth()).attr("y",c(0)).attr("height",0).attr("class",k.bind(a)).attr("class",function(t){const a=d3.select(d3.select(this).node().parentNode).attr("class").split("HERE").slice(1)[0];return a||t.category}).each(function(t){var e=-1!==I(i.call(a,t)).indexOf(" ")?i18next.t(I(i.call(a,t)),{ns:"cities"}):I(i.call(a,t)),n=i.call(a,t),r=R(t)+"_"+e,l=D(n),s=T(n),o=c(0);d3.select(this).attr("id",r).transition(y).attr("y",l<o?l:o).attr("height",s)}),l.attr("x",O).attr("width",s.bandwidth()).attr("class",k.bind(a)).each(function(t){var e=i.call(a,t),n=R(t)+"_"+I(e),r=D(e),l=T(e),s=c(0);d3.select(this).attr("id",n).transition(y).attr("y",r<s?r:s).attr("height",l)}),l.exit().remove()},O=function(){return s(a.z.getId.apply(a,arguments))},D=function(t){return c(a.y.getValue.call(a,t))},I=a.x.getId.bind(a),R=a.z.getId.bind(a),T=function(){var t=D.apply(this,arguments);return t<c(0)?c(0)-t:t-c(0)},w=a.x.getDomain.call(a,d);if(r=o.x=d3.scaleBand().rangeRound([0,p],.1).paddingOuter(a.pOuter).paddingInner(a.pInner),l=o.x0=d3.scaleBand().paddingInner(a.groupPadding),s=o.x1=d3.scaleBand().padding(a.barPadding),c=o.y=d3.scaleLinear().rangeRound([f,0]),l.domain(w).rangeRound([0,p]),s.domain(a.z.getDomain.call(a,e)).rangeRound([0,l.bandwidth()]),c.domain(a.y.getDomain.call(a,d)),r.domain(i.map(t=>t.city)),m.empty()&&(m=h.append("g").attr("class","data")),(t=m.selectAll(".bar-group").data(w.map(function(t){for(var e=0;e<d.length;e++)if(a.x.getValue.call(a,d[e])===t)return d[e]}).filter(function(t){return void 0!==t}),a.x.getId.bind(a))).enter().append("g").attr("class",b).attr("transform",v).each(z),t.attr("class",b).transition(y).attr("transform",v).each(z),t.exit().remove(),u.empty()){const t=0;u=h.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate("+t+","+f+")")}else u.select("text").text(n.x.label);u.call(d3.axisBottom(l).ticks(a.x.ticks).tickSizeOuter(a.x.tickSizeOuter?a.x.tickSizeOuter:null).tickFormat(a.x.getTickText?a.x.getTickText.bind(a):null)),u.selectAll(".tick").attr("class",function(t,a){return-1!==t.indexOf("_gap")?"hideTick":null}).selectAll("text").attr("id",function(t){return-1!==t.indexOf(" ")?"text_"+i18next.t(t,{ns:"cities"}):"text_"+t}).attr("transform","translate(0, -5) rotate(40)").attr("text-anchor","start"),g.empty()?(g=h.append("g").attr("class","y axis").attr("aria-hidden","true")).append("text").attr("class","chart-label").attr("fill","#000").attr("y","0").attr("dy","-0.5em").attr("text-anchor","end").text(a.y.label):g.select("text").text(n.y.label),g.call(d3.axisLeft(c).ticks(a.y.ticks).tickSizeOuter(a.y.tickSizeOuter?a.y.tickSizeOuter:null).tickFormat(a.y.getTickText?a.y.getTickText.bind(a):null))}).apply(o),d3.stcExt.addIEShim(e,x,g)},void 0===i?d3.json(u.url,function(t,a){i=a,d()}):d(),o},Math.sign||(Math.sign=function(t){return(t>0)-(t<0)||+t})}(jQuery.extend,jQuery);
